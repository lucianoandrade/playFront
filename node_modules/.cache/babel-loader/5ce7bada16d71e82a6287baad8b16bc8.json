{"ast":null,"code":"import _slicedToArray from \"/Users/luciano/Desktop/Projetos/PlayerStars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/luciano/Desktop/Projetos/PlayerStars/frontend/src/components/features/PageContainer/index.js\";\nimport React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Redirect, useLocation } from \"react-router-dom\";\nimport { Auth, API } from \"aws-amplify\";\nimport { connect } from \"react-redux\";\nimport { setUserData, setConsoles } from \"../../../store/actions/user.action\";\nimport config from \"../../../config/constants\";\nimport Loader from \"../../elements/Loader\";\nimport Menu from \"../Header/Menu\";\nimport Footer from \"../Footer\";\nimport { useAlert } from \"react-alert\";\n\nfunction PageContainer(props) {\n  const _useState = useState(true),\n        _useState2 = _slicedToArray(_useState, 2),\n        loading = _useState2[0],\n        setLoading = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        redirect = _useState4[0],\n        setRedirect = _useState4[1];\n\n  const _useState5 = useState(undefined),\n        _useState6 = _slicedToArray(_useState5, 2),\n        user_data = _useState6[0],\n        setUser_data = _useState6[1];\n\n  const _useState7 = useState(\"\"),\n        _useState8 = _slicedToArray(_useState7, 2),\n        to = _useState8[0],\n        setTo = _useState8[1];\n\n  const location = useLocation();\n\n  const redirect_to_error = error_message => {\n    setRedirect(true);\n    setLoading(false);\n    setTo(\"/\", {\n      state: {\n        message: error_message\n      }\n    });\n  };\n\n  const redirect_to_login = () => {\n    setRedirect(true);\n    setLoading(false);\n    setTo(\"/login\");\n  };\n\n  const redirect_to_cadastro = () => {\n    setRedirect(true);\n    setLoading(false);\n    setTo(\"/seus-dados\");\n  };\n\n  const redirect_to_home = () => {\n    setRedirect(true);\n    setLoading(false);\n    setTo(\"/\");\n  };\n\n  const alert = useAlert();\n\n  const get_user_data = cognito_response => {\n    const user_id = cognito_response.username;\n\n    if (props.user.data.entity_id) {\n      setLoading(false);\n      setUser_data({\n        cognito_user: cognito_response,\n        data: props.user\n      });\n      return;\n    }\n\n    API.get(config.APIS.PLAYERSTARS, \"/player/\".concat(user_id), {}).then(response => {\n      console.log(\"get user data bem sucedido. Response: \", response);\n      props.setUserData(response.data);\n      setUser_data({\n        cognito_user: cognito_response,\n        data: response.data\n      });\n    }).catch(error => {\n      console.log(\"get user data falhou: \", error);\n\n      if (error.response && error.response.status === 404) {\n        redirect_to_cadastro();\n      } else {\n        redirect_to_error(\"Erro obtendo dados do usuário\");\n        console.log(\"Erro obtendo dados o usuário: \", error.response);\n      }\n    });\n    API.get(config.APIS.PLAYERSTARS, \"/console/\").then(response => {\n      props.setConsoles(response.data);\n      setLoading(false);\n    }).catch(error => {\n      console.log(\"ERRO NO GET: \", error);\n    });\n  };\n\n  const get_authenticated_user = () => {\n    Auth.currentAuthenticatedUser().then(response => {\n      console.log(\"get_authenticated_user, response:\", response);\n\n      if (props.register) {\n        redirect_to_home();\n        alert.error(\"Você já está no sistema\");\n      }\n\n      if (!props.cadastro) {\n        get_user_data(response);\n      } else {\n        setLoading(false);\n        setUserData({\n          cognito_user: response\n        });\n      }\n    }).catch(error => {\n      if (props.register) {\n        setLoading(false);\n        setRedirect(false);\n      } else {\n        if (!props.public) {\n          if (error === \"not authenticated\") {\n            redirect_to_login();\n          } else {\n            redirect_to_error(error);\n          }\n        } else {\n          setLoading(false);\n        }\n      }\n    });\n  };\n\n  const has_user_data = () => {\n    return props.user_data !== undefined;\n  };\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n\n    if (!has_user_data()) {\n      return get_authenticated_user();\n    } // eslint-disable-next-line\n\n  }, []);\n\n  const renderLoading = () => {\n    return React.createElement(\"div\", {\n      className: \"Loading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(Loader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }));\n  };\n\n  const renderContent = () => {\n    const children = React.Children.map(props.children, child => React.cloneElement(child, {\n      user_data: user_data\n    }));\n    return React.createElement(React.Fragment, null, children);\n  };\n\n  const content = loading ? renderLoading() : renderContent();\n\n  if (redirect) {\n    return React.createElement(Redirect, {\n      to: to,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    });\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(Menu, {\n    user_data: user_data,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }), content, React.createElement(Footer, {\n    user_data: user_data,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }));\n}\n\nPageContainer.propTypes = {\n  background: PropTypes.any,\n  backgroundHeight: PropTypes.string,\n  public: PropTypes.bool,\n  cadastro: PropTypes.bool\n};\nexport default connect(state => {\n  const user = state.user;\n  return {\n    user\n  };\n}, {\n  setUserData,\n  setConsoles\n})(PageContainer);","map":{"version":3,"sources":["/Users/luciano/Desktop/Projetos/PlayerStars/frontend/src/components/features/PageContainer/index.js"],"names":["React","useState","useEffect","PropTypes","Redirect","useLocation","Auth","API","connect","setUserData","setConsoles","config","Loader","Menu","Footer","useAlert","PageContainer","props","loading","setLoading","redirect","setRedirect","undefined","user_data","setUser_data","to","setTo","location","redirect_to_error","error_message","state","message","redirect_to_login","redirect_to_cadastro","redirect_to_home","alert","get_user_data","cognito_response","user_id","username","user","data","entity_id","cognito_user","get","APIS","PLAYERSTARS","then","response","console","log","catch","error","status","get_authenticated_user","currentAuthenticatedUser","register","cadastro","public","has_user_data","window","scrollTo","renderLoading","renderContent","children","Children","map","child","cloneElement","content","propTypes","background","any","backgroundHeight","string","bool"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Redirect, useLocation } from \"react-router-dom\";\nimport { Auth, API } from \"aws-amplify\";\nimport { connect } from \"react-redux\";\nimport { setUserData, setConsoles } from \"../../../store/actions/user.action\";\nimport config from \"../../../config/constants\";\nimport Loader from \"../../elements/Loader\";\nimport Menu from \"../Header/Menu\";\nimport Footer from \"../Footer\";\nimport { useAlert } from \"react-alert\";\n\nfunction PageContainer(props) {\n  const [loading, setLoading] = useState(true);\n  const [redirect, setRedirect] = useState(false);\n  const [user_data, setUser_data] = useState(undefined);\n  const [to, setTo] = useState(\"\");\n  const location = useLocation();\n\n  const redirect_to_error = (error_message) => {\n    setRedirect(true);\n    setLoading(false);\n    setTo(\"/\", { state: { message: error_message } });\n  };\n\n  const redirect_to_login = () => {\n    setRedirect(true);\n    setLoading(false);\n    setTo(\"/login\");\n  };\n\n  const redirect_to_cadastro = () => {\n    setRedirect(true);\n    setLoading(false);\n    setTo(\"/seus-dados\");\n  };\n\n  const redirect_to_home = () => {\n    setRedirect(true);\n    setLoading(false);\n    setTo(\"/\");\n  };\n\n  const alert = useAlert();\n\n  const get_user_data = (cognito_response) => {\n    const user_id = cognito_response.username;\n\n    if (props.user.data.entity_id) {\n      setLoading(false);\n      setUser_data({ cognito_user: cognito_response, data: props.user });\n      return;\n    }\n\n    API.get(config.APIS.PLAYERSTARS, `/player/${user_id}`, {})\n      .then((response) => {\n        console.log(\"get user data bem sucedido. Response: \", response);\n        props.setUserData(response.data);\n        setUser_data({ cognito_user: cognito_response, data: response.data });\n      })\n      .catch((error) => {\n        console.log(\"get user data falhou: \", error);\n        if (error.response && error.response.status === 404) {\n          redirect_to_cadastro();\n        } else {\n          redirect_to_error(\"Erro obtendo dados do usuário\");\n          console.log(\"Erro obtendo dados o usuário: \", error.response);\n        }\n      });\n\n    API.get(config.APIS.PLAYERSTARS, \"/console/\")\n      .then((response) => {\n        props.setConsoles(response.data);\n        setLoading(false);\n      })\n      .catch((error) => {\n        console.log(\"ERRO NO GET: \", error);\n      });\n  };\n\n  const get_authenticated_user = () => {\n    Auth.currentAuthenticatedUser()\n      .then((response) => {\n        console.log(\"get_authenticated_user, response:\", response);\n        if (props.register) {\n          redirect_to_home();\n          alert.error(\"Você já está no sistema\");\n        }\n        if (!props.cadastro) {\n          get_user_data(response);\n        } else {\n          setLoading(false);\n          setUserData({ cognito_user: response });\n        }\n      })\n      .catch((error) => {\n        if (props.register) {\n          setLoading(false);\n          setRedirect(false);\n        } else {\n          if (!props.public) {\n            if (error === \"not authenticated\") {\n              redirect_to_login();\n            } else {\n              redirect_to_error(error);\n            }\n          } else {\n            setLoading(false);\n          }\n        }\n      });\n  };\n\n  const has_user_data = () => {\n    return props.user_data !== undefined;\n  };\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n    if (!has_user_data()) {\n      return get_authenticated_user();\n    }\n    // eslint-disable-next-line\n  }, []);\n\n  const renderLoading = () => {\n    return (\n      <div className=\"Loading\">\n        <Loader />\n      </div>\n    );\n  };\n\n  const renderContent = () => {\n    const children = React.Children.map(props.children, (child) =>\n      React.cloneElement(child, { user_data: user_data })\n    );\n    return <>{children}</>;\n  };\n\n  const content = loading ? renderLoading() : renderContent();\n\n  if (redirect) {\n    return <Redirect to={to} />;\n  }\n\n  return (\n    <>\n      <Menu user_data={user_data} />\n      {content}\n      <Footer user_data={user_data} />\n    </>\n  );\n}\n\nPageContainer.propTypes = {\n  background: PropTypes.any,\n  backgroundHeight: PropTypes.string,\n  public: PropTypes.bool,\n  cadastro: PropTypes.bool,\n};\n\nexport default connect(\n  (state) => {\n    const user = state.user;\n    return {\n      user,\n    };\n  },\n  {\n    setUserData,\n    setConsoles,\n  }\n)(PageContainer);\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _slicedToArray from \"/Users/luciano/Desktop/Projetos/PlayerStars/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/luciano/Desktop/Projetos/PlayerStars/frontend/src/components/features/PageContainer/index.js\";\nimport React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Redirect } from \"react-router-dom\";\nimport { Auth, API } from \"aws-amplify\";\nimport { useDispatch } from \"react-redux\";\nimport { setUserData, setConsoles } from \"../../../store/actions/user.action\";\nimport config from \"../../../config/constants\";\nimport Loader from \"../../elements/Loader\";\nimport Menu from \"../Header/Menu\";\nimport Footer from \"../Footer\";\n\nfunction PageContainer() {\n  const _useState = useState(true),\n        _useState2 = _slicedToArray(_useState, 2),\n        loading = _useState2[0],\n        setLoading = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        redirect = _useState4[0],\n        setRedirect = _useState4[1];\n\n  const _useState5 = useState(undefined),\n        _useState6 = _slicedToArray(_useState5, 2),\n        user_data = _useState6[0],\n        setUser_data = _useState6[1];\n\n  const _useState7 = useState(\"\"),\n        _useState8 = _slicedToArray(_useState7, 2),\n        to = _useState8[0],\n        setTo = _useState8[1];\n\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (!has_user_data()) {\n      get_authenticated_user();\n    } // eslint-disable-next-line\n\n  }, []);\n\n  const get_user_data = cognito => {\n    const user_id = cognito.attributes.sub;\n\n    if (cognito.user.data.entity_id) {\n      setLoading(false);\n      setUser_data({\n        cognito: cognito,\n        data: cognito.user\n      });\n      return;\n    }\n\n    API.get(config.APIS.PLAYERSTARS, \"/player/\".concat(user_id), {}).then(response => {\n      console.log(\"get user data bem sucedido. Response: \", response);\n      dispatch(setUserData(response.data));\n      setLoading(false);\n      setUser_data({\n        cognito: cognito,\n        data: response.data\n      });\n    }).catch(error => {\n      console.log(\"get user data falhou: \", error);\n\n      if (error.response && error.response.status === 404) {\n        setRedirect(true);\n        setLoading(false);\n        setTo(\"/seus-dados\");\n      } else {\n        setRedirect(true);\n        setLoading(false);\n        setTo(\"/\", {\n          state: {\n            message: error.message\n          }\n        });\n        console.log(\"Erro obtendo dados o usuário: \", error.response);\n      }\n    });\n    API.get(config.APIS.PLAYERSTARS, '/console/').then(response => {\n      console.log(\"ESSE E O RESPONSE\", response.data);\n      dispatch(setConsoles(response.data));\n    }).catch(error => {\n      console.log(\"ERRO NO GET: \");\n    });\n  };\n\n  const get_authenticated_user = () => {\n    Auth.currentAuthenticatedUser().then(response => {\n      console.log(\"get_authenticated_user, response:\", response);\n\n      if (is_register_view()) {\n        setRedirect(true);\n        setLoading(false);\n        setTo(\"/\");\n        alert(\"Você já está no sistema\");\n      }\n\n      if (is_cadastro_view()) {\n        get_user_data(response);\n      } else {\n        setLoading(false);\n        setUserData({\n          cognito_user: response\n        });\n      }\n    }).catch(error => {\n      if (is_register_view()) {\n        setLoading(false);\n        setRedirect(false);\n      } else {\n        if (!is_public_view()) {\n          if (error === \"not authenticated\") {\n            setRedirect(true);\n            setLoading(false);\n            setTo(\"/login\");\n          } else {\n            setRedirect(true);\n            setLoading(false);\n            setTo(\"/\", {\n              state: {\n                message: error.message\n              }\n            });\n          }\n        } else {\n          setLoading(false);\n        }\n      }\n    });\n  };\n\n  const is_cadastro_view = props => {\n    return props.cadastro;\n  };\n\n  const is_register_view = props => {\n    return props.register;\n  };\n\n  const is_public_view = props => {\n    return props.public;\n  };\n\n  const has_user_data = props => {\n    return props.user_data !== undefined;\n  };\n\n  const renderLoading = () => {\n    return React.createElement(\"div\", {\n      className: \"Loading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(Loader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }));\n  };\n\n  const renderContent = props => {\n    const children = React.Children.map(props.children, child => React.cloneElement(child, {\n      user_data: user_data\n    }));\n    return React.createElement(React.Fragment, null, children);\n  };\n\n  const content = loading ? renderLoading() : renderContent();\n\n  if (redirect) {\n    return React.createElement(Redirect, {\n      to: to,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    });\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(Menu, {\n    user_data: user_data,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }), content, React.createElement(Footer, {\n    user_data: user_data,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }));\n}\n\nPageContainer.propTypes = {\n  background: PropTypes.any,\n  backgroundHeight: PropTypes.string,\n  public: PropTypes.bool,\n  cadastro: PropTypes.bool\n};\nexport default PageContainer; // import React, { Component } from \"react\";\n// import PropTypes from \"prop-types\";\n// import { Redirect } from \"react-router-dom\";\n// import { Auth, API } from \"aws-amplify\";\n// import { connect } from \"react-redux\";\n// import { setUserData, setConsoles } from \"../../../store/actions/user.action\";\n// import config from \"../../../config/constants\";\n// import Loader from \"../../elements/Loader\";\n// import Menu from \"../Header/Menu\";\n// import Footer from \"../Footer\";\n// class PageContainer extends Component {\n//   state = {\n//     loading: true,\n//     redirect: false,\n//     user_data: undefined\n//   };\n//   redirect_to_error(error_message) {\n//     this.setState({\n//       redirect: true,\n//       loading: false,\n//       to: {\n//         pathname: \"/\",\n//         state: {\n//           message: error_message\n//         }\n//       }\n//     });\n//   }\n//   redirect_to_login() {\n//     this.setState({\n//       redirect: true,\n//       loading: false,\n//       to: {\n//         pathname: \"/login\"\n//       }\n//     });\n//   }\n//   redirect_to_cadastro() {\n//     this.setState({\n//       loading: false,\n//       redirect: true,\n//       to: { pathname: \"/seus-dados\" }\n//     });\n//   }\n//   redirect_to_home() {\n//     this.setState({\n//       redirect: true,\n//       loading: false,\n//       to: { pathname: \"/\" }\n//     });\n//   }\n//   get_user_data(cognito_response) {\n//     const user_id = cognito_response.attributes.sub;\n//     console.log(\"USER_ID:\", user_id);\n//     console.log(\"COGNITO RESPONSE: \", cognito_response);\n//     if (this.props.user.data.entity_id) {\n//       this.setState({\n//         loading: false,\n//         user_data: {\n//           cognito_user: cognito_response,\n//           data: this.props.user\n//         }\n//       });\n//       return;\n//     }\n//     API.get(config.APIS.PLAYERSTARS, `/player/${user_id}`, {})\n//       .then(response => {\n//         console.log(\"get user data bem sucedido. Response: \", response);\n//         this.props.setUserData(response.data);\n//         this.setState({\n//           loading: false,\n//           user_data: {\n//             cognito_user: cognito_response,\n//             data: response.data\n//           }\n//         });\n//       })\n//       .catch(error => {\n//         console.log(\"get user data falhou: \", error);\n//         if (error.response && error.response.status === 404) {\n//           this.redirect_to_cadastro();\n//         } else {\n//           this.redirect_to_error(\"Erro obtendo dados do usuário\"); //error.response.message)\n//           console.log(\"Erro obtendo dados o usuário: \", error.response);\n//         }\n//       });\n//       API.get(config.APIS.PLAYERSTARS, '/console/')\n//       .then(response => {\n//           console.log(\"ESSE E O RESPONSE\", response.data)\n//           this.props.setConsoles(response.data)\n//       })\n//       .catch(error => {\n//           console.log(\"ERRO NO GET: \")\n//       })\n//   }\n//   get_authenticated_user() {\n//     Auth.currentAuthenticatedUser()\n//       .then(response => {\n//         console.log(\"get_authenticated_user, response:\", response);\n//         if (this.is_register_view()) {\n//           this.redirect_to_home();\n//           alert(\"Você já está no sistema\");\n//         }\n//         if (!this.is_cadastro_view()) {\n//           this.get_user_data(response);\n//         } else {\n//           this.setState({\n//             loading: false,\n//             user_data: {\n//               cognito_user: response\n//             }\n//           });\n//         }\n//       })\n//       .catch(error => {\n//         if (this.is_register_view()) {\n//           this.setState({ loading: false, redirect: false });\n//         } else {\n//           if (!this.is_public_view()) {\n//             if (error === \"not authenticated\") {\n//               this.redirect_to_login();\n//             } else {\n//               this.redirect_to_error(error);\n//             }\n//           } else {\n//             this.setState({ loading: false });\n//           }\n//         }\n//       });\n//   }\n//   is_cadastro_view() {\n//     return this.props.cadastro;\n//   }\n//   is_register_view() {\n//     return this.props.register;\n//   }\n//   is_public_view() {\n//     return this.props.public;\n//   }\n//   has_user_data() {\n//     return this.props.user_data !== undefined;\n//   }\n//   componentDidMount() {\n//     window.scrollTo(0, 0);\n//     if (!this.has_user_data()) {\n//       this.get_authenticated_user();\n//     }\n//   }\n//   // noinspection JSMethodCanBeStatic\n//   renderLoading() {\n//     return (\n//       <div className=\"Loading\">\n//         <Loader />\n//       </div>\n//     );\n//   }\n//   renderContent() {\n//     const children = React.Children.map(this.props.children, child =>\n//       React.cloneElement(child, { user_data: this.state.user_data })\n//     );\n//     return <React.Fragment>{children}</React.Fragment>;\n//   }\n//   render() {\n//     console.log(\":::::::::::::\", this.props);\n//     if (this.state.redirect) {\n//       return <Redirect to={this.state.to} />;\n//     }\n//     const content = this.state.loading\n//       ? this.renderLoading()\n//       : this.renderContent();\n//     return (\n//       <React.Fragment>\n//         <Menu user_data={this.state.user_data} />\n//         {content}\n//         <Footer user_data={this.state.user_data} />\n//       </React.Fragment>\n//     );\n//   }\n// }\n// PageContainer.propTypes = {\n//   background: PropTypes.any,\n//   backgroundHeight: PropTypes.string,\n//   public: PropTypes.bool,\n//   cadastro: PropTypes.bool\n// };\n// export default connect(\n//   state => {\n//     const user = state.user;\n//     return {\n//       user\n//     };\n//   },\n//   {\n//     setUserData, setConsoles\n//   }\n// )(PageContainer);","map":{"version":3,"sources":["/Users/luciano/Desktop/Projetos/PlayerStars/frontend/src/components/features/PageContainer/index.js"],"names":["React","useState","useEffect","PropTypes","Redirect","Auth","API","useDispatch","setUserData","setConsoles","config","Loader","Menu","Footer","PageContainer","loading","setLoading","redirect","setRedirect","undefined","user_data","setUser_data","to","setTo","dispatch","has_user_data","get_authenticated_user","get_user_data","cognito","user_id","attributes","sub","user","data","entity_id","get","APIS","PLAYERSTARS","then","response","console","log","catch","error","status","state","message","currentAuthenticatedUser","is_register_view","alert","is_cadastro_view","cognito_user","is_public_view","props","cadastro","register","public","renderLoading","renderContent","children","Children","map","child","cloneElement","content","propTypes","background","any","backgroundHeight","string","bool"],"mappings":"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A;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Redirect } from \"react-router-dom\";\nimport { Auth, API } from \"aws-amplify\";\nimport { useDispatch } from \"react-redux\";\nimport { setUserData, setConsoles } from \"../../../store/actions/user.action\";\nimport config from \"../../../config/constants\";\nimport Loader from \"../../elements/Loader\";\nimport Menu from \"../Header/Menu\";\nimport Footer from \"../Footer\";\n\nfunction PageContainer () {\n\n  const [loading, setLoading] = useState(true);\n  const [redirect, setRedirect] = useState(false);\n  const [user_data, setUser_data] = useState(undefined);\n  const [to, setTo] = useState(\"\");\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (!has_user_data()) {\n      get_authenticated_user();\n    }\n    // eslint-disable-next-line\n  },[])\n\n\n  const get_user_data = (cognito) => {   \n    \n    const user_id = cognito.attributes.sub;\n\n    if (cognito.user.data.entity_id) {\n      setLoading(false);\n      setUser_data({cognito: cognito, data: cognito.user})\n      return;\n    }\n\n    API.get(config.APIS.PLAYERSTARS, `/player/${user_id}`, {})\n      .then(response => {\n        console.log(\"get user data bem sucedido. Response: \", response);\n        dispatch(setUserData(response.data));\n        setLoading(false);\n        setUser_data({cognito: cognito, data: response.data})\n      })\n      .catch(error => {\n        console.log(\"get user data falhou: \", error);\n        if (error.response && error.response.status === 404) {\n          setRedirect(true);\n          setLoading(false);\n          setTo(\"/seus-dados\")\n        } else {\n          setRedirect(true);\n          setLoading(false);\n          setTo(\"/\", {state: {message: error.message}});\n          console.log(\"Erro obtendo dados o usuário: \", error.response);\n        }\n      });\n      API.get(config.APIS.PLAYERSTARS, '/console/')\n      .then(response => {\n          console.log(\"ESSE E O RESPONSE\", response.data)\n          dispatch(setConsoles(response.data))\n      })\n      .catch(error => {\n          console.log(\"ERRO NO GET: \")\n      })\n  }\n\n  const get_authenticated_user = () => {\n    Auth.currentAuthenticatedUser()\n      .then(response => {\n        console.log(\"get_authenticated_user, response:\", response);\n        if (is_register_view()) {\n          setRedirect(true);\n          setLoading(false);\n          setTo(\"/\");\n          alert(\"Você já está no sistema\");\n        }\n        if (is_cadastro_view()) {\n          get_user_data(response);\n        } else {\n          setLoading(false);\n          setUserData({cognito_user: response});\n        }\n      })\n      .catch(error => {\n        if (is_register_view()) {\n          setLoading(false);\n          setRedirect(false);\n        } else {\n          if (!is_public_view()) {\n            if (error === \"not authenticated\") {\n              setRedirect(true);\n              setLoading(false);\n              setTo(\"/login\");\n            } else {\n              setRedirect(true);\n              setLoading(false);\n              setTo(\"/\", {state: {message: error.message}});\n            }\n          } else {\n            setLoading(false);\n          }\n        }\n      });\n  }\n\n  const is_cadastro_view = (props) => {\n    return props.cadastro;\n  }\n\n  const is_register_view = (props) => {\n    return props.register;\n  }\n\n  const is_public_view = (props) => {\n    return props.public;\n  }\n\n  const has_user_data = (props) => {\n    return props.user_data !== undefined;\n  }\n\n\n  const renderLoading = () => {\n    return (\n      <div className=\"Loading\">\n        <Loader />\n      </div>\n    );\n  }\n\n  const renderContent = (props) => {\n    const children = React.Children.map(props.children, child =>\n      React.cloneElement(child, {user_data: user_data })\n    );\n\n    return <>{children}</>;\n  }\n\n\n    const content = loading ? renderLoading() : renderContent();\n      \n    if (redirect) {\n      return <Redirect to={to} />;\n    }\n\n    return (\n      <>\n        <Menu user_data={user_data} />\n        {content}\n        <Footer user_data={user_data} />\n      </>\n    );  \n}\n\nPageContainer.propTypes = {\n  background: PropTypes.any,\n  backgroundHeight: PropTypes.string,\n  public: PropTypes.bool,\n  cadastro: PropTypes.bool\n};\n\nexport default PageContainer;\n\n// import React, { Component } from \"react\";\n// import PropTypes from \"prop-types\";\n// import { Redirect } from \"react-router-dom\";\n// import { Auth, API } from \"aws-amplify\";\n// import { connect } from \"react-redux\";\n// import { setUserData, setConsoles } from \"../../../store/actions/user.action\";\n// import config from \"../../../config/constants\";\n// import Loader from \"../../elements/Loader\";\n// import Menu from \"../Header/Menu\";\n// import Footer from \"../Footer\";\n\n// class PageContainer extends Component {\n//   state = {\n//     loading: true,\n//     redirect: false,\n//     user_data: undefined\n//   };\n\n//   redirect_to_error(error_message) {\n//     this.setState({\n//       redirect: true,\n//       loading: false,\n//       to: {\n//         pathname: \"/\",\n//         state: {\n//           message: error_message\n//         }\n//       }\n//     });\n//   }\n\n//   redirect_to_login() {\n//     this.setState({\n//       redirect: true,\n//       loading: false,\n//       to: {\n//         pathname: \"/login\"\n//       }\n//     });\n//   }\n\n//   redirect_to_cadastro() {\n//     this.setState({\n//       loading: false,\n//       redirect: true,\n//       to: { pathname: \"/seus-dados\" }\n//     });\n//   }\n\n//   redirect_to_home() {\n//     this.setState({\n//       redirect: true,\n//       loading: false,\n//       to: { pathname: \"/\" }\n//     });\n//   }\n\n//   get_user_data(cognito_response) {\n//     const user_id = cognito_response.attributes.sub;\n//     console.log(\"USER_ID:\", user_id);\n//     console.log(\"COGNITO RESPONSE: \", cognito_response);\n//     if (this.props.user.data.entity_id) {\n//       this.setState({\n//         loading: false,\n//         user_data: {\n//           cognito_user: cognito_response,\n//           data: this.props.user\n//         }\n//       });\n//       return;\n//     }\n//     API.get(config.APIS.PLAYERSTARS, `/player/${user_id}`, {})\n//       .then(response => {\n//         console.log(\"get user data bem sucedido. Response: \", response);\n//         this.props.setUserData(response.data);\n//         this.setState({\n//           loading: false,\n//           user_data: {\n//             cognito_user: cognito_response,\n//             data: response.data\n//           }\n//         });\n//       })\n//       .catch(error => {\n//         console.log(\"get user data falhou: \", error);\n//         if (error.response && error.response.status === 404) {\n//           this.redirect_to_cadastro();\n//         } else {\n//           this.redirect_to_error(\"Erro obtendo dados do usuário\"); //error.response.message)\n//           console.log(\"Erro obtendo dados o usuário: \", error.response);\n//         }\n//       });\n//       API.get(config.APIS.PLAYERSTARS, '/console/')\n//       .then(response => {\n//           console.log(\"ESSE E O RESPONSE\", response.data)\n//           this.props.setConsoles(response.data)\n//       })\n//       .catch(error => {\n//           console.log(\"ERRO NO GET: \")\n//       })\n//   }\n//   get_authenticated_user() {\n//     Auth.currentAuthenticatedUser()\n//       .then(response => {\n//         console.log(\"get_authenticated_user, response:\", response);\n//         if (this.is_register_view()) {\n//           this.redirect_to_home();\n//           alert(\"Você já está no sistema\");\n//         }\n//         if (!this.is_cadastro_view()) {\n//           this.get_user_data(response);\n//         } else {\n//           this.setState({\n//             loading: false,\n//             user_data: {\n//               cognito_user: response\n//             }\n//           });\n//         }\n//       })\n//       .catch(error => {\n//         if (this.is_register_view()) {\n//           this.setState({ loading: false, redirect: false });\n//         } else {\n//           if (!this.is_public_view()) {\n//             if (error === \"not authenticated\") {\n//               this.redirect_to_login();\n//             } else {\n//               this.redirect_to_error(error);\n//             }\n//           } else {\n//             this.setState({ loading: false });\n//           }\n//         }\n//       });\n//   }\n\n//   is_cadastro_view() {\n//     return this.props.cadastro;\n//   }\n\n//   is_register_view() {\n//     return this.props.register;\n//   }\n\n//   is_public_view() {\n//     return this.props.public;\n//   }\n\n//   has_user_data() {\n//     return this.props.user_data !== undefined;\n//   }\n\n//   componentDidMount() {\n//     window.scrollTo(0, 0);\n//     if (!this.has_user_data()) {\n//       this.get_authenticated_user();\n//     }\n//   }\n\n//   // noinspection JSMethodCanBeStatic\n//   renderLoading() {\n//     return (\n//       <div className=\"Loading\">\n//         <Loader />\n//       </div>\n//     );\n//   }\n\n//   renderContent() {\n//     const children = React.Children.map(this.props.children, child =>\n//       React.cloneElement(child, { user_data: this.state.user_data })\n//     );\n\n//     return <React.Fragment>{children}</React.Fragment>;\n//   }\n\n//   render() {\n//     console.log(\":::::::::::::\", this.props);\n//     if (this.state.redirect) {\n//       return <Redirect to={this.state.to} />;\n//     }\n\n//     const content = this.state.loading\n//       ? this.renderLoading()\n//       : this.renderContent();\n//     return (\n//       <React.Fragment>\n//         <Menu user_data={this.state.user_data} />\n//         {content}\n//         <Footer user_data={this.state.user_data} />\n//       </React.Fragment>\n//     );\n//   }\n// }\n\n// PageContainer.propTypes = {\n//   background: PropTypes.any,\n//   backgroundHeight: PropTypes.string,\n//   public: PropTypes.bool,\n//   cadastro: PropTypes.bool\n// };\n\n// export default connect(\n//   state => {\n//     const user = state.user;\n//     return {\n//       user\n//     };\n//   },\n//   {\n//     setUserData, setConsoles\n//   }\n// )(PageContainer);\n"]},"metadata":{},"sourceType":"module"}